<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
    <script>
      window.OneSignal = window.OneSignal || [];
      OneSignal.push(function() {
        OneSignal.init({
          appId: "3e056ceb-bf3c-4ca1-b0a6-f12b2b8319bc",
        });
      });
    </script> -->
    
    <style>
      .disabled {
        background-color: #222;
      }
    </style>
  </head>
<body>
  <h1>Hello, Web Push</h1>
  <button type="button" onclick="sendFlareLaneDemoNotification(this)">Send Demo Notification</button>
  
  <script src="https://cdn.flarelane.com/WebSDK-staging.js"></script>
  <script>
      FlareLane.initialize({ projectId: "249f20f0-2b55-4b67-bf65-51b365296e3e" });
  </script>

  <script>function sendFlareLaneDemoNotification(button){const e=()=>{button.disabled=!1,button.classList.remove("disabled")},t={API_URL:"https://staging-service-api.flarelane.com/send-demo-notification",DRAFT_STORE_ID:"flarelane_dndly",delayTime:3e3,isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,fetch:{method:"POST",headers:{"Content-Type":"application/json"}},class:{disabled:"disabled"}},i="iOS 웹 푸시는 지원 예정입니다. 안드로이드 폰이나 PC 환경에서 다시 시도해보세요.",a="잠시 후 구독 팝업이 노출됩니다. 조금만 기다려주세요!",d="왼쪽 아래 종 모양 버튼을 클릭하여 알림 구독을 먼저 진행하세요.";try{if(t.isIOS)return void alert(i);if(!FlareLane.initialized)return void alert(a);button.disabled=!0,button.classList.add("disabled");const n=Number(localStorage.getItem(t.DRAFT_STORE_ID)),o=(new Date).getTime();if(n&&o-n<t.delayTime)return void e();FlareLane.getIsSubscribed(i=>{i?FlareLane.getDeviceId((function(i){if(fetch)return i?void fetch(t.API_URL,{method:t.fetch.method,headers:t.fetch.headers,body:JSON.stringify({deviceId:i})}).then((function(){e()})).catch((function(){e()})):(alert(d),void e());e()})):(alert(d),e())}),localStorage.setItem(t.DRAFT_STORE_ID,String(o))}catch{e()}}</script>
</body>
</html>
